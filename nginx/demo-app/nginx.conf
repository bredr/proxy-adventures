error_log  "/opt/bitnami/nginx/logs/error.log";
pid        "/opt/bitnami/nginx/tmp/nginx.pid";

events {}

http {
    include       mime.types;
    default_type  application/octet-stream;
    client_body_temp_path  "/opt/bitnami/nginx/tmp/client_body" 1 2;
    proxy_temp_path "/opt/bitnami/nginx/tmp/proxy" 1 2;
    fastcgi_temp_path "/opt/bitnami/nginx/tmp/fastcgi" 1 2;
    scgi_temp_path "/opt/bitnami/nginx/tmp/scgi" 1 2;
    uwsgi_temp_path "/opt/bitnami/nginx/tmp/uwsgi" 1 2;
    access_log  "/opt/bitnami/nginx/logs/access.log";

    client_header_timeout 3000;
    client_body_timeout 3000;
    fastcgi_read_timeout 3000;
    client_max_body_size 1024m;
    fastcgi_buffers 8 128k;
    fastcgi_buffer_size 128k;

    server {
            gzip on;
            listen 3000;
            root /opt/bitnami/nginx/www;
            index index.html index.htm;
            auth_request /auth;
            auth_request_set $auth_status $upstream_status;

            location /auth {
                internal;
                proxy_pass ${AUTH_SERVICE};
                proxy_pass_request_body off;
                proxy_set_header Content-Length "";
                proxy_set_header X-Original-URI $request_uri;
            }

            location ~* \.html$ {
                expires off;
            }
            location ~* \.(ogg|ogv|svg|svgz|eot|otf|woff|mp4|mp3|ttf|css|rss|atom|js|jpg|jpeg|gif|png|ico|zip|tgz|gz|rar|bz2|doc|xls|exe|ppt|tar|mid|midi|wav|bmp|rtf)(\?ver=[0-9.]+)?$ {
	            access_log off; 
                log_not_found off; 
	            expires max;
            }
            location / {
                try_files $uri /index.html =404;
            }
    }
}
